(self.webpackChunksite=self.webpackChunksite||[]).push([[6670],{6547:(n,s,a)=>{"use strict";a.r(s),a.d(s,{data:()=>e});const e={key:"v-6eb4b7cd",path:"/guide/basic/menu.html",title:"菜单配置",lang:"zh-CN",frontmatter:{title:"菜单配置",order:4},excerpt:"",headers:[{level:2,title:"基本配置",slug:"基本配置",children:[]},{level:2,title:"菜单图标",slug:"菜单图标",children:[]},{level:2,title:"菜单权限",slug:"菜单权限",children:[]}],filePathRelative:"guide/basic/menu.md",git:{updatedTime:1621352433e3,contributors:[]}}},3157:(n,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>U});var e=a(6252);const p=(0,e.Uk)("在 "),t={href:"https://unpkg.com/@alifd/fusion-design-pro-js@0.1.23/build/index.html#/dashboard/analysis",target:"_blank",rel:"noopener noreferrer"},l=(0,e.Uk)("Pro"),c=(0,e.Uk)(" 模板中，菜单按照一定的约定进行配置，用来描述菜单栏的结构关系。以 "),i=(0,e.Wm)("code",null,"BasicLayout",-1),o=(0,e.Uk)(" 布局为例，菜单配置文件约定在 "),r=(0,e.Wm)("code",null,"src/layouts/BasicLayout/menuConfig.ts",-1),u=(0,e.Uk)("中。"),k=(0,e.uE)('<h2 id="基本配置"><a class="header-anchor" href="#基本配置">#</a> 基本配置</h2><p>菜单配置包含 headerMenuConfig 和 asideMenuConfig 两种形式，headerMenuConfig 用于顶部菜单栏的渲染，asideMenuConfig 用于侧边菜单栏的渲染，这样方便在统一的位置管理应用布局的菜单信息：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token comment">// 顶部菜单栏配置</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> headerMenuConfig <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;Home&#39;</span><span class="token punctuation">,</span>                       <span class="token comment">// 菜单名称</span>\n    path<span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>                          <span class="token comment">// 菜单路径</span>\n    icon<span class="token operator">:</span> <span class="token string">&#39;message&#39;</span>                     <span class="token comment">// 菜单图标</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token comment">// 侧边菜单栏配置</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> asideMenuConfig <span class="token operator">=</span> <span class="token punctuation">[</span>\n  <span class="token punctuation">{</span>\n    name<span class="token operator">:</span> <span class="token string">&#39;Dashboard&#39;</span><span class="token punctuation">,</span>                  <span class="token comment">// 一级菜单名称</span>\n    path<span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>                          <span class="token comment">// 一级菜单路径</span>\n    icon<span class="token operator">:</span> <span class="token string">&#39;edit&#39;</span><span class="token punctuation">,</span>                       <span class="token comment">// 一级菜单图标</span>\n    <span class="token comment">// 二级菜单配置</span>\n    children<span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token punctuation">{</span>\n        name<span class="token operator">:</span> <span class="token string">&#39;Analysis&#39;</span><span class="token punctuation">,</span>               <span class="token comment">// 二级菜单名称</span>\n        path<span class="token operator">:</span> <span class="token string">&#39;/dashboard/analysis&#39;</span><span class="token punctuation">,</span>    <span class="token comment">// 二级菜单路径</span>\n      <span class="token punctuation">}</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span>\n        name<span class="token operator">:</span> <span class="token string">&#39;DashboardChild&#39;</span><span class="token punctuation">,</span>\n        path<span class="token operator">:</span> <span class="token string">&#39;/&#39;</span><span class="token punctuation">,</span>\n        icon<span class="token operator">:</span> <span class="token string">&#39;add&#39;</span><span class="token punctuation">,</span>\n        <span class="token comment">// 三级菜单配置</span>\n        children<span class="token operator">:</span> <span class="token punctuation">[</span>\n          <span class="token punctuation">{</span>\n            name<span class="token operator">:</span> <span class="token string">&#39;Monitor&#39;</span><span class="token punctuation">,</span>            <span class="token comment">// 三级菜单名称</span>\n            path<span class="token operator">:</span> <span class="token string">&#39;/dashboard/monitor&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 三级菜单路径 </span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token comment">// ...</span>\n<span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div>',3),m=(0,e.Uk)("完整的菜单渲染逻辑可参考 "),b={href:"https://github.com/alibaba-fusion/materials/blob/master/scaffolds/scaffold-lite/src/layouts/BasicLayout/components/PageNav/index.tsx",target:"_blank",rel:"noopener noreferrer"},d=(0,e.Uk)("src/layouts/BasicLayout/components/PageNav/index.tsx"),g=(0,e.Uk)("。"),h=(0,e.Wm)("h2",{id:"菜单图标"},[(0,e.Wm)("a",{class:"header-anchor",href:"#菜单图标"},"#"),(0,e.Uk)(" 菜单图标")],-1),f=(0,e.Uk)("我们默认使用 "),x={href:"/component/icon",target:"_blank",rel:"noopener noreferrer"},v=(0,e.Uk)("Icon"),y=(0,e.Uk)(" 这个组件渲染图标，可以使用哪些图标可以在组件文档中看到，如果有其他自定义的图标需求，将代码改为对应图标组件即可。"),M=(0,e.uE)('<div class="language-jsx ext-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">SubNav</span></span>\n  <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span>\n  <span class="token attr-name">icon</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>icon<span class="token punctuation">}</span></span>\n  <span class="token attr-name">label</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span>\n<span class="token punctuation">&gt;</span></span><span class="token plain-text">\n  </span><span class="token punctuation">{</span>childrenItems<span class="token punctuation">}</span><span class="token plain-text">\n</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">SubNav</span></span><span class="token punctuation">&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="菜单权限"><a class="header-anchor" href="#菜单权限">#</a> 菜单权限</h2><p>首先在 <code>src/layouts/BasicLayout/menuConfig.ts</code> 中增加以下的内容：</p><div class="language-diff ext-diff line-numbers-mode"><pre class="language-diff"><code>export const asideMenuConfig = [\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> {\n</span><span class="token prefix unchanged"> </span><span class="token line">   name: &#39;Home&#39;,\n</span><span class="token prefix unchanged"> </span><span class="token line">   path: &#39;/&#39;,\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   auth: [&#39;guest&#39;]\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },\n</span></span>];\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>然后在 <code>src/layouts/BasicLayout/components/PageNav/index.tsx</code>中配置以下内容：</p><div class="language-diff ext-diff line-numbers-mode"><pre class="language-diff"><code><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> import { useAuth } from &#39;ice&#39;;\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> function getNavMenuItems(menusData, initIndex) {\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function getNavMenuItems(menusData, initIndex, auth) {\n</span></span>\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> return menusData\n</span><span class="token prefix deleted">-</span><span class="token line">   .filter(item =&gt; item.name &amp;&amp; !item.hideInMenu)\n</span><span class="token prefix deleted">-</span><span class="token line">   .map((item, index) =&gt; {\n</span><span class="token prefix deleted">-</span><span class="token line">     return getSubMenuOrItem(item, `${initIndex}-${index}`);\n</span><span class="token prefix deleted">-</span><span class="token line">   });\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> return menusData.filter(item =&gt; {\n</span><span class="token prefix inserted">+</span><span class="token line">   let roleAuth = true;\n</span><span class="token prefix inserted">+</span><span class="token line">   if (auth &amp;&amp; item.auth &amp;&amp; item.auth instanceof Array) {\n</span><span class="token prefix inserted">+</span><span class="token line">     if (item.auth.length) {\n</span><span class="token prefix inserted">+</span><span class="token line">       // 获取当前用户是否有该菜单的权限\n</span><span class="token prefix inserted">+</span><span class="token line">       roleAuth = item.auth.some(key =&gt; auth[key]);\n</span><span class="token prefix inserted">+</span><span class="token line">     }\n</span><span class="token prefix inserted">+</span><span class="token line">   }\n</span><span class="token prefix inserted">+</span><span class="token line">   return item.name &amp;&amp; !item.hideInMenu &amp;&amp; roleAuth;\n</span><span class="token prefix inserted">+</span><span class="token line"> }).map((item, index) =&gt; {\n</span><span class="token prefix inserted">+</span><span class="token line">   getSubMenuOrItem(item, `${initIndex}-${index}`, auth)\n</span><span class="token prefix inserted">+</span><span class="token line"> });\n</span></span>}\n\n<span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> function getSubMenuOrItem(item, index) {\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> function getSubMenuOrItem(item, index, auth) {\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> if (item.children &amp;&amp; item.children.some(child =&gt; child.name)) {\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   const childrenItems = getNavMenuItems(item.children, index);\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   const childrenItems = getNavMenuItems(item.children, index, auth);\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   // ...\n</span><span class="token prefix unchanged"> </span><span class="token line"> }\n</span></span>}\n\nconst Navigation = () =&gt; {\n<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> // 获取权限数据 更多权限管理的内容可以参考: https://ice.work/docs/guide/advance/auth\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const [auth] = useAuth();\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> return (\n</span><span class="token prefix unchanged"> </span><span class="token line">   &lt;Nav embeddable activeDirection=&quot;right&quot;&gt;\n</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">     {getNavMenuItems(asideMenuConfig, 0)}\n</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     {getNavMenuItems(asideMenuConfig, 0, auth)}\n</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;/Nav&gt;\n</span><span class="token prefix unchanged"> </span><span class="token line"> )\n</span></span>}\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div>',6),I=(0,e.Uk)("完整的菜单权限实现可参考 "),N={href:"https://github.com/alibaba-fusion/materials/blob/master/scaffolds/fusion-design-pro/src/layouts/BasicLayout/components/PageNav/index.tsx",target:"_blank",rel:"noopener noreferrer"},W=(0,e.Uk)("src/layouts/BasicLayout/components/PageNav/index.tsx"),C=(0,e.Uk)("。"),U={render:function(n,s){const a=(0,e.up)("OutboundLink");return(0,e.wg)(),(0,e.j4)(e.HY,null,[(0,e.Wm)("p",null,[p,(0,e.Wm)("a",t,[l,(0,e.Wm)(a)]),c,i,o,r,u]),k,(0,e.Wm)("p",null,[m,(0,e.Wm)("a",b,[d,(0,e.Wm)(a)]),g]),h,(0,e.Wm)("p",null,[f,(0,e.Wm)("a",x,[v,(0,e.Wm)(a)]),y]),M,(0,e.Wm)("p",null,[I,(0,e.Wm)("a",N,[W,(0,e.Wm)(a)]),C])],64)}}}}]);